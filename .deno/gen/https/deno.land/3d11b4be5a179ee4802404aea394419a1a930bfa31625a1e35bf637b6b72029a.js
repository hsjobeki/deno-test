import { core } from "./_core.ts";
import { validateFunction } from "./internal/validators.mjs";
import { _exiting } from "./_process/exiting.ts";
import { FixedQueue } from "./internal/fixed_queue.ts";
const queue = new FixedQueue();
let _nextTick;
export function processTicksAndRejections() {
    let tock;
    do {
        while (tock = queue.shift()) {
            try {
                const callback = tock.callback;
                if (tock.args === undefined) {
                    callback();
                }
                else {
                    const args = tock.args;
                    switch (args.length) {
                        case 1:
                            callback(args[0]);
                            break;
                        case 2:
                            callback(args[0], args[1]);
                            break;
                        case 3:
                            callback(args[0], args[1], args[2]);
                            break;
                        case 4:
                            callback(args[0], args[1], args[2], args[3]);
                            break;
                        default:
                            callback(...args);
                    }
                }
            }
            finally {
            }
        }
        core.runMicrotasks();
    } while (!queue.isEmpty());
    core.setHasTickScheduled(false);
}
if (typeof core.setNextTickCallback !== "undefined") {
    function runNextTicks() {
        if (!core.hasTickScheduled()) {
            core.runMicrotasks();
        }
        if (!core.hasTickScheduled()) {
            return true;
        }
        processTicksAndRejections();
        return true;
    }
    core.setNextTickCallback(processTicksAndRejections);
    core.setMacrotaskCallback(runNextTicks);
    function __nextTickNative(callback, ...args) {
        validateFunction(callback, "callback");
        if (_exiting) {
            return;
        }
        let args_;
        switch (args.length) {
            case 0:
                break;
            case 1:
                args_ = [args[0]];
                break;
            case 2:
                args_ = [args[0], args[1]];
                break;
            case 3:
                args_ = [args[0], args[1], args[2]];
                break;
            default:
                args_ = new Array(args.length);
                for (let i = 0; i < args.length; i++) {
                    args_[i] = args[i];
                }
        }
        if (queue.isEmpty()) {
            core.setHasTickScheduled(true);
        }
        const tickObject = {
            callback,
            args: args_,
        };
        queue.push(tickObject);
    }
    _nextTick = __nextTickNative;
}
else {
    function __nextTickQueueMicrotask(callback, ...args) {
        if (args) {
            queueMicrotask(() => callback.call(this, ...args));
        }
        else {
            queueMicrotask(callback);
        }
    }
    _nextTick = __nextTickQueueMicrotask;
}
export function nextTick(callback, ...args) {
    _nextTick(callback, ...args);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiX25leHRfdGljay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIl9uZXh0X3RpY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBS0EsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNsQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUM3RCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDakQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBT3ZELE1BQU0sS0FBSyxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7QUFHL0IsSUFBSSxTQUFjLENBQUM7QUFFbkIsTUFBTSxVQUFVLHlCQUF5QjtJQUN2QyxJQUFJLElBQUksQ0FBQztJQUNULEdBQUc7UUFFRCxPQUFPLElBQUksR0FBRyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFLM0IsSUFBSTtnQkFDRixNQUFNLFFBQVEsR0FBSSxJQUFhLENBQUMsUUFBUSxDQUFDO2dCQUN6QyxJQUFLLElBQWEsQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO29CQUNyQyxRQUFRLEVBQUUsQ0FBQztpQkFDWjtxQkFBTTtvQkFDTCxNQUFNLElBQUksR0FBSSxJQUFhLENBQUMsSUFBSSxDQUFDO29CQUNqQyxRQUFRLElBQUksQ0FBQyxNQUFNLEVBQUU7d0JBQ25CLEtBQUssQ0FBQzs0QkFDSixRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQ2xCLE1BQU07d0JBQ1IsS0FBSyxDQUFDOzRCQUNKLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQzNCLE1BQU07d0JBQ1IsS0FBSyxDQUFDOzRCQUNKLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FB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LENBQUMsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUNwRDthQUFNO1lBQ0wsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzFCO0lBQ0gsQ0FBQztJQUVELFNBQVMsR0FBRyx3QkFBd0IsQ0FBQztDQUN0QztBQVVELE1BQU0sVUFBVSxRQUFRLENBRXRCLFFBQThCLEVBQzlCLEdBQUcsSUFBTztJQUVWLFNBQVMsQ0FBQyxRQUFRLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztBQUMvQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuXG4vLyBkZW5vLWxpbnQtaWdub3JlLWZpbGUgbm8taW5uZXItZGVjbGFyYXRpb25zXG5cbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi9fY29yZS50c1wiO1xuaW1wb3J0IHsgdmFsaWRhdGVGdW5jdGlvbiB9IGZyb20gXCIuL2ludGVybmFsL3ZhbGlkYXRvcnMubWpzXCI7XG5pbXBvcnQgeyBfZXhpdGluZyB9IGZyb20gXCIuL19wcm9jZXNzL2V4aXRpbmcudHNcIjtcbmltcG9ydCB7IEZpeGVkUXVldWUgfSBmcm9tIFwiLi9pbnRlcm5hbC9maXhlZF9xdWV1ZS50c1wiO1xuXG5pbnRlcmZhY2UgVG9jayB7XG4gIGNhbGxiYWNrOiAoLi4uYXJnczogQXJyYXk8dW5rbm93bj4pID0+IHZvaWQ7XG4gIGFyZ3M6IEFycmF5PHVua25vd24+O1xufVxuXG5jb25zdCBxdWV1ZSA9IG5ldyBGaXhlZFF1ZXVlKCk7XG5cbi8vIGRlbm8tbGludC1pZ25vcmUgbm8tZXhwbGljaXQtYW55XG5sZXQgX25leHRUaWNrOiBhbnk7XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzVGlja3NBbmRSZWplY3Rpb25zKCkge1xuICBsZXQgdG9jaztcbiAgZG8ge1xuICAgIC8vIGRlbm8tbGludC1pZ25vcmUgbm8tY29uZC1hc3NpZ25cbiAgICB3aGlsZSAodG9jayA9IHF1ZXVlLnNoaWZ0KCkpIHtcbiAgICAgIC8vIEZJWE1FKGJhcnRsb21pZWp1KTogRGVubyBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0IGFzeW5jIGhvb2tzXG4gICAgICAvLyBjb25zdCBhc3luY0lkID0gdG9ja1thc3luY19pZF9zeW1ib2xdO1xuICAgICAgLy8gZW1pdEJlZm9yZShhc3luY0lkLCB0b2NrW3RyaWdnZXJfYXN5bmNfaWRfc3ltYm9sXSwgdG9jayk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrID0gKHRvY2sgYXMgVG9jaykuY2FsbGJhY2s7XG4gICAgICAgIGlmICgodG9jayBhcyBUb2NrKS5hcmdzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGFyZ3MgPSAodG9jayBhcyBUb2NrKS5hcmdzO1xuICAgICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIGNhbGxiYWNrKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgY2FsbGJhY2soLi4uYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyBGSVhNRShiYXJ0bG9taWVqdSk6IERlbm8gY3VycmVudGx5IGRvZXNuJ3Qgc3VwcG9ydCBhc3luYyBob29rc1xuICAgICAgICAvLyBpZiAoZGVzdHJveUhvb2tzRXhpc3QoKSlcbiAgICAgICAgLy8gZW1pdERlc3Ryb3koYXN5bmNJZCk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZJWE1FKGJhcnRsb21pZWp1KTogRGVubyBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0IGFzeW5jIGhvb2tzXG4gICAgICAvLyBlbWl0QWZ0ZXIoYXN5bmNJZCk7XG4gICAgfVxuICAgIGNvcmUucnVuTWljcm90YXNrcygpO1xuICAgIC8vIEZJWE1FKGJhcnRsb21pZWp1KTogRGVubyBjdXJyZW50bHkgZG9lc24ndCB1bmhhbmRsZWQgcmVqZWN0aW9uc1xuICAgIC8vIH0gd2hpbGUgKCFxdWV1ZS5pc0VtcHR5KCkgfHwgcHJvY2Vzc1Byb21pc2VSZWplY3Rpb25zKCkpO1xuICB9IHdoaWxlICghcXVldWUuaXNFbXB0eSgpKTtcbiAgY29yZS5zZXRIYXNUaWNrU2NoZWR1bGVkKGZhbHNlKTtcbiAgLy8gRklYTUUoYmFydGxvbWllanUpOiBEZW5vIGN1cnJlbnRseSBkb2Vzbid0IHVuaGFuZGxlZCByZWplY3Rpb25zXG4gIC8vIHNldEhhc1JlamVjdGlvblRvV2FybihmYWxzZSk7XG59XG5cbmlmICh0eXBlb2YgY29yZS5zZXROZXh0VGlja0NhbGxiYWNrICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gIGZ1bmN0aW9uIHJ1bk5leHRUaWNrcygpIHtcbiAgICAvLyBGSVhNRShiYXJ0bG9taWVqdSk6IERlbm8gY3VycmVudGx5IGRvZXNuJ3QgdW5oYW5kbGVkIHJlamVjdGlvbnNcbiAgICAvLyBpZiAoIWhhc1RpY2tTY2hlZHVsZWQoKSAmJiAhaGFzUmVqZWN0aW9uVG9XYXJuKCkpXG4gICAgLy8gICBydW5NaWNyb3Rhc2tzKCk7XG4gICAgLy8gaWYgKCFoYXNUaWNrU2NoZWR1bGVkKCkgJiYgIWhhc1JlamVjdGlvblRvV2FybigpKVxuICAgIC8vICAgcmV0dXJuO1xuICAgIGlmICghY29yZS5oYXNUaWNrU2NoZWR1bGVkKCkpIHtcbiAgICAgIGNvcmUucnVuTWljcm90YXNrcygpO1xuICAgIH1cbiAgICBpZiAoIWNvcmUuaGFzVGlja1NjaGVkdWxlZCgpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwcm9jZXNzVGlja3NBbmRSZWplY3Rpb25zKCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBjb3JlLnNldE5leHRUaWNrQ2FsbGJhY2socHJvY2Vzc1RpY2tzQW5kUmVqZWN0aW9ucyk7XG4gIGNvcmUuc2V0TWFjcm90YXNrQ2FsbGJhY2socnVuTmV4dFRpY2tzKTtcblxuICBmdW5jdGlvbiBfX25leHRUaWNrTmF0aXZlPFQgZXh0ZW5kcyBBcnJheTx1bmtub3duPj4oXG4gICAgdGhpczogdW5rbm93bixcbiAgICBjYWxsYmFjazogKC4uLmFyZ3M6IFQpID0+IHZvaWQsXG4gICAgLi4uYXJnczogVFxuICApIHtcbiAgICB2YWxpZGF0ZUZ1bmN0aW9uKGNhbGxiYWNrLCBcImNhbGxiYWNrXCIpO1xuXG4gICAgaWYgKF9leGl0aW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVE9ETyhiYXJ0bG9taWVqdSk6IHNlZW1zIHN1cGVyZmx1b3VzIGlmIHdlIGRvbid0IGRlcGVuZCBvbiBgYXJndW1lbnRzYFxuICAgIGxldCBhcmdzXztcbiAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgICBhcmdzXyA9IFthcmdzWzBdXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGFyZ3NfID0gW2FyZ3NbMF0sIGFyZ3NbMV1dO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgYXJnc18gPSBbYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXV07XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYXJnc18gPSBuZXcgQXJyYXkoYXJncy5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcmdzX1tpXSA9IGFyZ3NbaV07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocXVldWUuaXNFbXB0eSgpKSB7XG4gICAgICBjb3JlLnNldEhhc1RpY2tTY2hlZHVsZWQodHJ1ZSk7XG4gICAgfVxuICAgIC8vIEZJWE1FKGJhcnRsb21pZWp1KTogRGVubyBjdXJyZW50bHkgZG9lc24ndCBzdXBwb3J0IGFzeW5jIGhvb2tzXG4gICAgLy8gY29uc3QgYXN5bmNJZCA9IG5ld0FzeW5jSWQoKTtcbiAgICAvLyBjb25zdCB0cmlnZ2VyQXN5bmNJZCA9IGdldERlZmF1bHRUcmlnZ2VyQXN5bmNJZCgpO1xuICAgIGNvbnN0IHRpY2tPYmplY3QgPSB7XG4gICAgICAvLyBGSVhNRShiYXJ0bG9taWVqdSk6IERlbm8gY3VycmVudGx5IGRvZXNuJ3Qgc3VwcG9ydCBhc3luYyBob29rc1xuICAgICAgLy8gW2FzeW5jX2lkX3N5bWJvbF06IGFzeW5jSWQsXG4gICAgICAvLyBbdHJpZ2dlcl9hc3luY19pZF9zeW1ib2xdOiB0cmlnZ2VyQXN5bmNJZCxcbiAgICAgIGNhbGxiYWNrLFxuICAgICAgYXJnczogYXJnc18sXG4gICAgfTtcbiAgICAvLyBGSVhNRShiYXJ0bG9taWVqdSk6IERlbm8gY3VycmVudGx5IGRvZXNuJ3Qgc3VwcG9ydCBhc3luYyBob29rc1xuICAgIC8vIGlmIChpbml0SG9va3NFeGlzdCgpKVxuICAgIC8vICAgZW1pdEluaXQoYXN5bmNJZCwgJ1RpY2tPYmplY3QnLCB0cmlnZ2VyQXN5bmNJZCwgdGlja09iamVjdCk7XG4gICAgcXVldWUucHVzaCh0aWNrT2JqZWN0KTtcbiAgfVxuICBfbmV4dFRpY2sgPSBfX25leHRUaWNrTmF0aXZlO1xufSBlbHNlIHtcbiAgZnVuY3Rpb24gX19uZXh0VGlja1F1ZXVlTWljcm90YXNrPFQgZXh0ZW5kcyBBcnJheTx1bmtub3duPj4oXG4gICAgdGhpczogdW5rbm93bixcbiAgICBjYWxsYmFjazogKC4uLmFyZ3M6IFQpID0+IHZvaWQsXG4gICAgLi4uYXJnczogVFxuICApIHtcbiAgICBpZiAoYXJncykge1xuICAgICAgcXVldWVNaWNyb3Rhc2soKCkgPT4gY2FsbGJhY2suY2FsbCh0aGlzLCAuLi5hcmdzKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHF1ZXVlTWljcm90YXNrKGNhbGxiYWNrKTtcbiAgICB9XG4gIH1cblxuICBfbmV4dFRpY2sgPSBfX25leHRUaWNrUXVldWVNaWNyb3Rhc2s7XG59XG5cbi8vIGBuZXh0VGljaygpYCB3aWxsIG5vdCBlbnF1ZXVlIGFueSBjYWxsYmFjayB3aGVuIHRoZSBwcm9jZXNzIGlzIGFib3V0IHRvXG4vLyBleGl0IHNpbmNlIHRoZSBjYWxsYmFjayB3b3VsZCBub3QgaGF2ZSBhIGNoYW5jZSB0byBiZSBleGVjdXRlZC5cbmV4cG9ydCBmdW5jdGlvbiBuZXh0VGljayh0aGlzOiB1bmtub3duLCBjYWxsYmFjazogKCkgPT4gdm9pZCk6IHZvaWQ7XG5leHBvcnQgZnVuY3Rpb24gbmV4dFRpY2s8VCBleHRlbmRzIEFycmF5PHVua25vd24+PihcbiAgdGhpczogdW5rbm93bixcbiAgY2FsbGJhY2s6ICguLi5hcmdzOiBUKSA9PiB2b2lkLFxuICAuLi5hcmdzOiBUXG4pOiB2b2lkO1xuZXhwb3J0IGZ1bmN0aW9uIG5leHRUaWNrPFQgZXh0ZW5kcyBBcnJheTx1bmtub3duPj4oXG4gIHRoaXM6IHVua25vd24sXG4gIGNhbGxiYWNrOiAoLi4uYXJnczogVCkgPT4gdm9pZCxcbiAgLi4uYXJnczogVFxuKSB7XG4gIF9uZXh0VGljayhjYWxsYmFjaywgLi4uYXJncyk7XG59XG4iXX0=