import { kHandle } from "./constants.ts";
import { ERR_INVALID_ARG_TYPE, ERR_INVALID_ARG_VALUE } from "../errors.ts";
import { notImplemented } from "../../_utils.ts";
import { isCryptoKey, isKeyObject, kKeyType } from "./_keys.ts";
export { isCryptoKey, isKeyObject };
export class KeyObject {
    [kKeyType];
    [kHandle];
    constructor(type, handle) {
        if (type !== "secret" && type !== "public" && type !== "private") {
            throw new ERR_INVALID_ARG_VALUE("type", type);
        }
        if (typeof handle !== "object") {
            throw new ERR_INVALID_ARG_TYPE("handle", "object", handle);
        }
        this[kKeyType] = type;
        Object.defineProperty(this, kHandle, {
            value: handle,
            enumerable: false,
            configurable: false,
            writable: false,
        });
    }
    get type() {
        return this[kKeyType];
    }
    get asymmetricKeyDetails() {
        notImplemented("crypto.KeyObject.prototype.asymmetricKeyDetails");
        return undefined;
    }
    get asymmetricKeyType() {
        notImplemented("crypto.KeyObject.prototype.asymmetricKeyType");
        return undefined;
    }
    get symmetricKeySize() {
        notImplemented("crypto.KeyObject.prototype.symmetricKeySize");
        return undefined;
    }
    static from(key) {
        if (!isCryptoKey(key)) {
            throw new ERR_INVALID_ARG_TYPE("key", "CryptoKey", key);
        }
        notImplemented("crypto.KeyObject.prototype.from");
    }
    equals(otherKeyObject) {
        if (!isKeyObject(otherKeyObject)) {
            throw new ERR_INVALID_ARG_TYPE("otherKeyObject", "KeyObject", otherKeyObject);
        }
        notImplemented("crypto.KeyObject.prototype.equals");
    }
    export(_options) {
        notImplemented("crypto.KeyObject.prototype.asymmetricKeyType");
    }
}
export function createPrivateKey(_key) {
    notImplemented("crypto.createPrivateKey");
}
export function createPublicKey(_key) {
    notImplemented("crypto.createPublicKey");
}
export function createSecretKey(_key, _encoding) {
    notImplemented("crypto.createSecretKey");
}
export default {
    isKeyObject,
    isCryptoKey,
    KeyObject,
    createPrivateKey,
    createPublicKey,
    createSecretKey,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2V5cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImtleXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3pDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUMzRSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFRakQsT0FBTyxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRWhFLE9BQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLENBQUM7QUE4Q3BDLE1BQU0sT0FBTyxTQUFTO0lBQ3BCLENBQUMsUUFBUSxDQUFDLENBQWdCO0lBQzFCLENBQUMsT0FBTyxDQUFDLENBQVU7SUFFbkIsWUFBWSxJQUFtQixFQUFFLE1BQWU7UUFDOUMsSUFBSSxJQUFJLEtBQUssUUFBUSxJQUFJLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLFNBQVMsRUFBRTtZQUNoRSxNQUFNLElBQUkscUJBQXFCLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQy9DO1FBRUQsSUFBSSxPQUFPLE1BQU0sS0FBSyxRQUFRLEVBQUU7WUFDOUIsTUFBTSxJQUFJLG9CQUFvQixDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDNUQ7UUFFRCxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBRXRCLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNuQyxLQUFLLEVBQUUsTUFBTTtZQUNiLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLFlBQVksRUFBRSxLQUFLO1lBQ25CLFFBQVEsRUFBRSxLQUFLO1NBQ2hCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxJQUFJLElBQUk7UUFDTixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN4QixDQUFDO0lBRUQsSUFBSSxvQkFBb0I7UUFDdEIsY0FBYyxDQUFDLGlEQUFpRCxDQUFDLENBQUM7UUFFbEUsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVELElBQUksaUJBQWlCO1FBQ25CLGNBQWMsQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO1FBRS9ELE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7SUFFRCxJQUFJLGdCQUFnQjtRQUNsQixjQUFjLENBQUMsNkNBQTZDLENBQUMsQ0FBQztRQUU5RCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBRUQsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFjO1FBQ3hCLElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDckIsTUFBTSxJQUFJLG9CQUFvQixDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDekQ7UUFFRCxjQUFjLENBQUMsaUNBQWlDLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBRUQsTUFBTSxDQUFDLGNBQXlCO1FBQzlCLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLEVBQUU7WUFDaEMsTUFBTSxJQUFJLG9CQUFvQixDQUM1QixnQkFBZ0IsRUFDaEIsV0FBVyxFQUNYLGNBQWMsQ0FDZixDQUFDO1NBQ0g7UUFFRCxjQUFjLENBQUMsbUNBQW1DLENBQUMsQ0FBQztJQUN0RCxDQUFDO0lBS0QsTUFBTSxDQUFDLFFBQWtCO1FBQ3ZCLGNBQWMsQ0FBQyw4Q0FBOEMsQ0FBQyxDQUFDO0lBQ2pFLENBQUM7Q0FDRjtBQU9ELE1BQU0sVUFBVSxnQkFBZ0IsQ0FDOUIsSUFBeUQ7SUFFekQsY0FBYyxDQUFDLHlCQUF5QixDQUFDLENBQUM7QUFDNUMsQ0FBQztBQUVELE1BQU0sVUFBVSxlQUFlLENBQzdCLElBQW9FO0lBRXBFLGNBQWMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQzNDLENBQUM7QUFPRCxNQUFNLFVBQVUsZUFBZSxDQUM3QixJQUE4QixFQUM5QixTQUFrQjtJQUVsQixjQUFjLENBQUMsd0JBQXdCLENBQUMsQ0FBQztBQUMzQyxDQUFDO0FBRUQsZUFBZTtJQUNiLFdBQVc7SUFDWCxXQUFXO0lBQ1gsU0FBUztJQUNULGdCQUFnQjtJQUNoQixlQUFlO0lBQ2YsZUFBZTtDQUNoQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTgtMjAyMiB0aGUgRGVubyBhdXRob3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIE5vZGUuanMgY29udHJpYnV0b3JzLiBBbGwgcmlnaHRzIHJlc2VydmVkLiBNSVQgbGljZW5zZS5cblxuaW1wb3J0IHsga0hhbmRsZSB9IGZyb20gXCIuL2NvbnN0YW50cy50c1wiO1xuaW1wb3J0IHsgRVJSX0lOVkFMSURfQVJHX1RZUEUsIEVSUl9JTlZBTElEX0FSR19WQUxVRSB9IGZyb20gXCIuLi9lcnJvcnMudHNcIjtcbmltcG9ydCB7IG5vdEltcGxlbWVudGVkIH0gZnJvbSBcIi4uLy4uL191dGlscy50c1wiO1xuaW1wb3J0IHR5cGUge1xuICBLZXlGb3JtYXQsXG4gIEtleVR5cGUsXG4gIFByaXZhdGVLZXlJbnB1dCxcbiAgUHVibGljS2V5SW5wdXQsXG59IGZyb20gXCIuL3R5cGVzLnRzXCI7XG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiLi4vLi4vYnVmZmVyLnRzXCI7XG5pbXBvcnQgeyBpc0NyeXB0b0tleSwgaXNLZXlPYmplY3QsIGtLZXlUeXBlIH0gZnJvbSBcIi4vX2tleXMudHNcIjtcblxuZXhwb3J0IHsgaXNDcnlwdG9LZXksIGlzS2V5T2JqZWN0IH07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXN5bW1ldHJpY0tleURldGFpbHMge1xuICAvKipcbiAgICogS2V5IHNpemUgaW4gYml0cyAoUlNBLCBEU0EpLlxuICAgKi9cbiAgbW9kdWx1c0xlbmd0aD86IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIFB1YmxpYyBleHBvbmVudCAoUlNBKS5cbiAgICovXG4gIHB1YmxpY0V4cG9uZW50PzogYmlnaW50IHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogTmFtZSBvZiB0aGUgbWVzc2FnZSBkaWdlc3QgKFJTQS1QU1MpLlxuICAgKi9cbiAgaGFzaEFsZ29yaXRobT86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE5hbWUgb2YgdGhlIG1lc3NhZ2UgZGlnZXN0IHVzZWQgYnkgTUdGMSAoUlNBLVBTUykuXG4gICAqL1xuICBtZ2YxSGFzaEFsZ29yaXRobT86IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE1pbmltYWwgc2FsdCBsZW5ndGggaW4gYnl0ZXMgKFJTQS1QU1MpLlxuICAgKi9cbiAgc2FsdExlbmd0aD86IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIFNpemUgb2YgcSBpbiBiaXRzIChEU0EpLlxuICAgKi9cbiAgZGl2aXNvckxlbmd0aD86IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE5hbWUgb2YgdGhlIGN1cnZlIChFQykuXG4gICAqL1xuICBuYW1lZEN1cnZlPzogc3RyaW5nIHwgdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgdHlwZSBLZXlPYmplY3RUeXBlID0gXCJzZWNyZXRcIiB8IFwicHVibGljXCIgfCBcInByaXZhdGVcIjtcblxuZXhwb3J0IGludGVyZmFjZSBLZXlFeHBvcnRPcHRpb25zPFQgZXh0ZW5kcyBLZXlGb3JtYXQ+IHtcbiAgdHlwZTogXCJwa2NzMVwiIHwgXCJzcGtpXCIgfCBcInBrY3M4XCIgfCBcInNlYzFcIjtcbiAgZm9ybWF0OiBUO1xuICBjaXBoZXI/OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIHBhc3NwaHJhc2U/OiBzdHJpbmcgfCBCdWZmZXIgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSndrS2V5RXhwb3J0T3B0aW9ucyB7XG4gIGZvcm1hdDogXCJqd2tcIjtcbn1cblxuZXhwb3J0IGNsYXNzIEtleU9iamVjdCB7XG4gIFtrS2V5VHlwZV06IEtleU9iamVjdFR5cGU7XG4gIFtrSGFuZGxlXTogdW5rbm93bjtcblxuICBjb25zdHJ1Y3Rvcih0eXBlOiBLZXlPYmplY3RUeXBlLCBoYW5kbGU6IHVua25vd24pIHtcbiAgICBpZiAodHlwZSAhPT0gXCJzZWNyZXRcIiAmJiB0eXBlICE9PSBcInB1YmxpY1wiICYmIHR5cGUgIT09IFwicHJpdmF0ZVwiKSB7XG4gICAgICB0aHJvdyBuZXcgRVJSX0lOVkFMSURfQVJHX1ZBTFVFKFwidHlwZVwiLCB0eXBlKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGhhbmRsZSAhPT0gXCJvYmplY3RcIikge1xuICAgICAgdGhyb3cgbmV3IEVSUl9JTlZBTElEX0FSR19UWVBFKFwiaGFuZGxlXCIsIFwib2JqZWN0XCIsIGhhbmRsZSk7XG4gICAgfVxuXG4gICAgdGhpc1trS2V5VHlwZV0gPSB0eXBlO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGtIYW5kbGUsIHtcbiAgICAgIHZhbHVlOiBoYW5kbGUsXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgfSk7XG4gIH1cblxuICBnZXQgdHlwZSgpOiBLZXlPYmplY3RUeXBlIHtcbiAgICByZXR1cm4gdGhpc1trS2V5VHlwZV07XG4gIH1cblxuICBnZXQgYXN5bW1ldHJpY0tleURldGFpbHMoKTogQXN5bW1ldHJpY0tleURldGFpbHMgfCB1bmRlZmluZWQge1xuICAgIG5vdEltcGxlbWVudGVkKFwiY3J5cHRvLktleU9iamVjdC5wcm90b3R5cGUuYXN5bW1ldHJpY0tleURldGFpbHNcIik7XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgZ2V0IGFzeW1tZXRyaWNLZXlUeXBlKCk6IEtleVR5cGUgfCB1bmRlZmluZWQge1xuICAgIG5vdEltcGxlbWVudGVkKFwiY3J5cHRvLktleU9iamVjdC5wcm90b3R5cGUuYXN5bW1ldHJpY0tleVR5cGVcIik7XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgZ2V0IHN5bW1ldHJpY0tleVNpemUoKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICBub3RJbXBsZW1lbnRlZChcImNyeXB0by5LZXlPYmplY3QucHJvdG90eXBlLnN5bW1ldHJpY0tleVNpemVcIik7XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgc3RhdGljIGZyb20oa2V5OiBDcnlwdG9LZXkpOiBLZXlPYmplY3Qge1xuICAgIGlmICghaXNDcnlwdG9LZXkoa2V5KSkge1xuICAgICAgdGhyb3cgbmV3IEVSUl9JTlZBTElEX0FSR19UWVBFKFwia2V5XCIsIFwiQ3J5cHRvS2V5XCIsIGtleSk7XG4gICAgfVxuXG4gICAgbm90SW1wbGVtZW50ZWQoXCJjcnlwdG8uS2V5T2JqZWN0LnByb3RvdHlwZS5mcm9tXCIpO1xuICB9XG5cbiAgZXF1YWxzKG90aGVyS2V5T2JqZWN0OiBLZXlPYmplY3QpOiBib29sZWFuIHtcbiAgICBpZiAoIWlzS2V5T2JqZWN0KG90aGVyS2V5T2JqZWN0KSkge1xuICAgICAgdGhyb3cgbmV3IEVSUl9JTlZBTElEX0FSR19UWVBFKFxuICAgICAgICBcIm90aGVyS2V5T2JqZWN0XCIsXG4gICAgICAgIFwiS2V5T2JqZWN0XCIsXG4gICAgICAgIG90aGVyS2V5T2JqZWN0LFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBub3RJbXBsZW1lbnRlZChcImNyeXB0by5LZXlPYmplY3QucHJvdG90eXBlLmVxdWFsc1wiKTtcbiAgfVxuXG4gIGV4cG9ydChvcHRpb25zOiBLZXlFeHBvcnRPcHRpb25zPFwicGVtXCI+KTogc3RyaW5nIHwgQnVmZmVyO1xuICBleHBvcnQob3B0aW9ucz86IEtleUV4cG9ydE9wdGlvbnM8XCJkZXJcIj4pOiBCdWZmZXI7XG4gIGV4cG9ydChvcHRpb25zPzogSndrS2V5RXhwb3J0T3B0aW9ucyk6IEpzb25XZWJLZXk7XG4gIGV4cG9ydChfb3B0aW9ucz86IHVua25vd24pOiBzdHJpbmcgfCBCdWZmZXIgfCBKc29uV2ViS2V5IHtcbiAgICBub3RJbXBsZW1lbnRlZChcImNyeXB0by5LZXlPYmplY3QucHJvdG90eXBlLmFzeW1tZXRyaWNLZXlUeXBlXCIpO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSnNvbldlYktleUlucHV0IHtcbiAga2V5OiBKc29uV2ViS2V5O1xuICBmb3JtYXQ6IFwiandrXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQcml2YXRlS2V5KFxuICBfa2V5OiBQcml2YXRlS2V5SW5wdXQgfCBzdHJpbmcgfCBCdWZmZXIgfCBKc29uV2ViS2V5SW5wdXQsXG4pOiBLZXlPYmplY3Qge1xuICBub3RJbXBsZW1lbnRlZChcImNyeXB0by5jcmVhdGVQcml2YXRlS2V5XCIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUHVibGljS2V5KFxuICBfa2V5OiBQdWJsaWNLZXlJbnB1dCB8IHN0cmluZyB8IEJ1ZmZlciB8IEtleU9iamVjdCB8IEpzb25XZWJLZXlJbnB1dCxcbik6IEtleU9iamVjdCB7XG4gIG5vdEltcGxlbWVudGVkKFwiY3J5cHRvLmNyZWF0ZVB1YmxpY0tleVwiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlY3JldEtleShrZXk6IEFycmF5QnVmZmVyVmlldyk6IEtleU9iamVjdDtcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZWNyZXRLZXkoXG4gIGtleTogc3RyaW5nLFxuICBlbmNvZGluZzogc3RyaW5nLFxuKTogS2V5T2JqZWN0O1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlY3JldEtleShcbiAgX2tleTogc3RyaW5nIHwgQXJyYXlCdWZmZXJWaWV3LFxuICBfZW5jb2Rpbmc/OiBzdHJpbmcsXG4pOiBLZXlPYmplY3Qge1xuICBub3RJbXBsZW1lbnRlZChcImNyeXB0by5jcmVhdGVTZWNyZXRLZXlcIik7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgaXNLZXlPYmplY3QsXG4gIGlzQ3J5cHRvS2V5LFxuICBLZXlPYmplY3QsXG4gIGNyZWF0ZVByaXZhdGVLZXksXG4gIGNyZWF0ZVB1YmxpY0tleSxcbiAgY3JlYXRlU2VjcmV0S2V5LFxufTtcbiJdfQ==